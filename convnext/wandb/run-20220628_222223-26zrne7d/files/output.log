
Starting training

Epoch [1/200]:   8%|███████████▍                                                                                                                                        | 1/13 [00:04<00:52,  4.35s/it, loss=0.187]
torch.Size([128, 512])

Epoch [1/200]:  15%|██████████████████████▊                                                                                                                             | 2/13 [00:08<00:45,  4.18s/it, loss=0.156]

Epoch [1/200]:  23%|██████████████████████████████████▏                                                                                                                 | 3/13 [00:12<00:40,  4.05s/it, loss=0.162]

Epoch [1/200]:  31%|█████████████████████████████████████████████▌                                                                                                      | 4/13 [00:16<00:37,  4.12s/it, loss=0.129]

Epoch [1/200]:  38%|████████████████████████████████████████████████████████▉                                                                                           | 5/13 [00:20<00:32,  4.10s/it, loss=0.137]

Epoch [1/200]:  46%|████████████████████████████████████████████████████████████████████▎                                                                               | 6/13 [00:24<00:28,  4.13s/it, loss=0.117]

Epoch [1/200]:  54%|███████████████████████████████████████████████████████████████████████████████▋                                                                    | 7/13 [00:29<00:25,  4.17s/it, loss=0.104]

Epoch [1/200]:  62%|███████████████████████████████████████████████████████████████████████████████████████████                                                         | 8/13 [00:33<00:20,  4.17s/it, loss=0.106]

Epoch [1/200]:  69%|██████████████████████████████████████████████████████████████████████████████████████████████████████▍                                             | 9/13 [00:37<00:16,  4.16s/it, loss=0.093]


Epoch [1/200]:  77%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                 | 10/13 [00:41<00:12,  4.18s/it, loss=0.0897]


Epoch [1/200]:  85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                      | 11/13 [00:45<00:08,  4.18s/it, loss=0.0865]


Epoch [1/200]:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊           | 12/13 [00:49<00:04,  4.14s/it, loss=0.0959]

Epoch [1/200]:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊           | 12/13 [00:53<00:04,  4.14s/it, loss=0.0959]
lr 0.001485
Epoch 1
 Current loss 0.11917406611731868
compute roc mode:  testing

torch.Size([64, 512])
compute roc mode:  testing
torch.Size([64, 512])
compute roc mode:  testing
torch.Size([64, 512])
compute roc mode:  testing
torch.Size([64, 512])
compute roc mode:  testing
torch.Size([12, 512])
compute roc mode:  training
torch.Size([64, 512])
compute roc mode:  training
torch.Size([64, 512])
compute roc mode:  training
torch.Size([64, 512])
compute roc mode:  training
torch.Size([64, 512])
compute roc mode:  training
torch.Size([19, 512])
I
I
I
I
I
I
I
I
I
I
I
I
I
C
I
I
I
C
C
I
I
I
I
I
I
I
I
I
I
C
I
Epoch avg. auc value: 0.8184944662126824
Epoch one-shot accuracy: 0.12903225806451613
Best threshold running-average value: 0.8859066486358642
  0%|                                                                                                                                                                                       | 0/13 [00:00<?, ?it/s]

Epoch [2/200]:   8%|███████████▎                                                                                                                                       | 1/13 [00:04<00:50,  4.24s/it, loss=0.0926]

Epoch [2/200]:  15%|██████████████████████▌                                                                                                                            | 2/13 [00:08<00:44,  4.04s/it, loss=0.0882]

Epoch [2/200]:  23%|█████████████████████████████████▉                                                                                                                 | 3/13 [00:12<00:41,  4.12s/it, loss=0.0759]

Epoch [2/200]:  31%|█████████████████████████████████████████████▏                                                                                                     | 4/13 [00:16<00:36,  4.07s/it, loss=0.0719]

Epoch [2/200]:  38%|████████████████████████████████████████████████████████▌                                                                                          | 5/13 [00:20<00:32,  4.06s/it, loss=0.0709]

Epoch [2/200]:  46%|███████████████████████████████████████████████████████████████████▊                                                                               | 6/13 [00:24<00:28,  4.07s/it, loss=0.0807]

Epoch [2/200]:  54%|███████████████████████████████████████████████████████████████████████████████▏                                                                   | 7/13 [00:28<00:23,  3.98s/it, loss=0.0732]

Epoch [2/200]:  62%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                        | 8/13 [00:32<00:19,  3.98s/it, loss=0.0807]

Epoch [2/200]:  69%|█████████████████████████████████████████████████████████████████████████████████████████████████████▊                                             | 9/13 [00:36<00:16,  4.04s/it, loss=0.0663]

Epoch [2/200]:  77%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                 | 10/13 [00:40<00:12,  4.03s/it, loss=0.0837]

Epoch [2/200]:  85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                      | 11/13 [00:44<00:08,  4.05s/it, loss=0.0733]

Epoch [2/200]:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊           | 12/13 [00:48<00:04,  4.10s/it, loss=0.0667]
torch.Size([124, 512])
lr 0.00147015
Epoch 2

 Current loss 0.07765778636066435
compute roc mode:  testing
torch.Size([64, 512])
compute roc mode:  testing
torch.Size([64, 512])
compute roc mode:  testing
torch.Size([64, 512])
compute roc mode:  testing
torch.Size([64, 512])
compute roc mode:  testing
torch.Size([12, 512])
compute roc mode:  training
torch.Size([64, 512])
compute roc mode:  training
torch.Size([64, 512])
compute roc mode:  training
torch.Size([64, 512])
compute roc mode:  training
torch.Size([64, 512])
compute roc mode:  training
torch.Size([19, 512])
I
C
I
I
I
I
C
C
I
I
I
I
I
I
I
I
I
C
C
I
C
I
I
I
I
I
I
I
I
I
I
Epoch avg. auc value: 0.8697618451551641
Epoch one-shot accuracy: 0.1935483870967742
Best threshold running-average value: 0.8859136223793029
  0%|                                                                                                                                                                                       | 0/13 [00:00<?, ?it/s]

Epoch [3/200]:   8%|███████████▎                                                                                                                                       | 1/13 [00:03<00:47,  3.98s/it, loss=0.0658]

Epoch [3/200]:  15%|██████████████████████▌                                                                                                                            | 2/13 [00:08<00:44,  4.04s/it, loss=0.0727]

Epoch [3/200]:  23%|█████████████████████████████████▉                                                                                                                 | 3/13 [00:12<00:39,  4.00s/it, loss=0.0745]

Epoch [3/200]:  31%|█████████████████████████████████████████████▏                                                                                                     | 4/13 [00:16<00:36,  4.02s/it, loss=0.0787]

Epoch [3/200]:  38%|████████████████████████████████████████████████████████▌                                                                                          | 5/13 [00:19<00:31,  3.97s/it, loss=0.0614]

Epoch [3/200]:  46%|███████████████████████████████████████████████████████████████████▊                                                                               | 6/13 [00:23<00:27,  3.93s/it, loss=0.0668]

Epoch [3/200]:  54%|███████████████████████████████████████████████████████████████████████████████▏                                                                   | 7/13 [00:27<00:23,  3.84s/it, loss=0.0631]

Epoch [3/200]:  62%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                        | 8/13 [00:31<00:19,  3.99s/it, loss=0.0674]

Epoch [3/200]:  69%|█████████████████████████████████████████████████████████████████████████████████████████████████████▊                                             | 9/13 [00:35<00:15,  3.99s/it, loss=0.0627]

Epoch [3/200]:  77%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                  | 10/13 [00:40<00:12,  4.09s/it, loss=0.069]

Epoch [3/200]:  85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                      | 11/13 [00:43<00:07,  3.99s/it, loss=0.0759]

Epoch [3/200]:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊           | 12/13 [00:47<00:03,  3.99s/it, loss=0.0633]
torch.Size([124, 512])
lr 0.0014554485
Epoch 3
 Current loss 0.06823523244730957

compute roc mode:  testing
torch.Size([64, 512])
compute roc mode:  testing
torch.Size([64, 512])
compute roc mode:  testing
torch.Size([64, 512])
compute roc mode:  testing
torch.Size([64, 512])
compute roc mode:  testing
torch.Size([12, 512])
compute roc mode:  training
torch.Size([64, 512])
compute roc mode:  training
torch.Size([64, 512])
compute roc mode:  training
torch.Size([64, 512])
compute roc mode:  training
torch.Size([64, 512])
compute roc mode:  training
torch.Size([19, 512])
I
I
I
I
I
C
I
I
I
I
C
I
I
C
I
I
I
I
I
I
I
I
I
I
I
C
I
I
C
C
C
Epoch avg. auc value: 0.9071000449997755
Epoch one-shot accuracy: 0.22580645161290322
Best threshold running-average value: 0.8859286069869995
  0%|                                                                                                                                                                                       | 0/13 [00:00<?, ?it/s]

Epoch [4/200]:   8%|███████████▎                                                                                                                                       | 1/13 [00:03<00:47,  3.99s/it, loss=0.0634]

Epoch [4/200]:  15%|██████████████████████▌                                                                                                                            | 2/13 [00:07<00:43,  3.96s/it, loss=0.0635]

Epoch [4/200]:  23%|█████████████████████████████████▉                                                                                                                 | 3/13 [00:11<00:39,  3.92s/it, loss=0.0619]

Epoch [4/200]:  31%|█████████████████████████████████████████████▏                                                                                                     | 4/13 [00:15<00:35,  3.92s/it, loss=0.0575]

Epoch [4/200]:  38%|████████████████████████████████████████████████████████▌                                                                                          | 5/13 [00:19<00:32,  4.01s/it, loss=0.0686]

Epoch [4/200]:  46%|███████████████████████████████████████████████████████████████████▊                                                                               | 6/13 [00:23<00:27,  3.94s/it, loss=0.0626]

Epoch [4/200]:  54%|███████████████████████████████████████████████████████████████████████████████▏                                                                   | 7/13 [00:27<00:23,  3.99s/it, loss=0.0705]

Epoch [4/200]:  62%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                        | 8/13 [00:31<00:19,  3.99s/it, loss=0.0628]

Epoch [4/200]:  69%|█████████████████████████████████████████████████████████████████████████████████████████████████████▊                                             | 9/13 [00:35<00:15,  3.99s/it, loss=0.0618]

Epoch [4/200]:  77%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                 | 10/13 [00:39<00:12,  4.02s/it, loss=0.0631]

Epoch [4/200]:  85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                      | 11/13 [00:44<00:08,  4.08s/it, loss=0.0637]

Epoch [4/200]:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊           | 12/13 [00:48<00:04,  4.12s/it, loss=0.0685]
torch.Size([124, 512])
lr 0.001440894015
Epoch 4

 Current loss 0.06444276714909639
compute roc mode:  testing
torch.Size([64, 512])
compute roc mode:  testing
torch.Size([64, 512])
compute roc mode:  testing
torch.Size([64, 512])
compute roc mode:  testing
torch.Size([64, 512])
compute roc mode:  testing
torch.Size([12, 512])
compute roc mode:  training
torch.Size([64, 512])
compute roc mode:  training
torch.Size([64, 512])
compute roc mode:  training
torch.Size([64, 512])
compute roc mode:  training
torch.Size([64, 512])
compute roc mode:  training
torch.Size([19, 512])
I
C
I
C
I
I
C
C
I
I
I
C
I
C
I
I
I
C
I
C
I
I
C
I
I
I
I
I
I
I
I
Epoch avg. auc value: 0.896843869602883
Epoch one-shot accuracy: 0.2903225806451613
Best threshold running-average value: 0.8835679918527602
  0%|                                                                                                                                                                                       | 0/13 [00:00<?, ?it/s]

Epoch [5/200]:   8%|███████████▎                                                                                                                                       | 1/13 [00:03<00:45,  3.82s/it, loss=0.0628]

Epoch [5/200]:  15%|██████████████████████▌                                                                                                                            | 2/13 [00:08<00:44,  4.06s/it, loss=0.0606]

Epoch [5/200]:  23%|█████████████████████████████████▉                                                                                                                 | 3/13 [00:12<00:40,  4.02s/it, loss=0.0609]

Epoch [5/200]:  31%|█████████████████████████████████████████████▏                                                                                                     | 4/13 [00:16<00:37,  4.13s/it, loss=0.0595]

Epoch [5/200]:  38%|████████████████████████████████████████████████████████▉                                                                                           | 5/13 [00:20<00:32,  4.08s/it, loss=0.056]

Epoch [5/200]:  46%|████████████████████████████████████████████████████████████████████▊                                                                                | 6/13 [00:24<00:28,  4.05s/it, loss=0.06]

Epoch [5/200]:  54%|███████████████████████████████████████████████████████████████████████████████▏                                                                   | 7/13 [00:28<00:24,  4.05s/it, loss=0.0676]

Epoch [5/200]:  62%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                        | 8/13 [00:32<00:20,  4.16s/it, loss=0.0578]

Epoch [5/200]:  69%|█████████████████████████████████████████████████████████████████████████████████████████████████████▊                                             | 9/13 [00:36<00:16,  4.14s/it, loss=0.0609]

Epoch [5/200]:  77%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                 | 10/13 [00:40<00:12,  4.14s/it, loss=0.0523]

Epoch [5/200]:  85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                      | 11/13 [00:45<00:08,  4.13s/it, loss=0.0566]

Epoch [5/200]:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊           | 12/13 [00:49<00:04,  4.09s/it, loss=0.0532]
torch.Size([124, 512])
lr 0.00142648507485
Epoch 5

 Current loss 0.05910398971454186
compute roc mode:  testing
torch.Size([64, 512])
compute roc mode:  testing
torch.Size([64, 512])
compute roc mode:  testing
torch.Size([64, 512])
compute roc mode:  testing
torch.Size([64, 512])
compute roc mode:  testing
torch.Size([12, 512])
compute roc mode:  training
torch.Size([64, 512])
compute roc mode:  training
torch.Size([64, 512])
compute roc mode:  training
torch.Size([64, 512])
compute roc mode:  training
torch.Size([64, 512])
compute roc mode:  training
torch.Size([19, 512])
C
I
I
I
C
I
I
I
I
C
I
I
I
C
I
I
I
I
I
C
I
I
C
C
I
C
I
I
I
I
I
Epoch avg. auc value: 0.88914133789829
Epoch one-shot accuracy: 0.25806451612903225
Best threshold running-average value: 0.8878690123558044
  0%|                                                                                                                                                                                       | 0/13 [00:00<?, ?it/s]

Epoch [6/200]:   8%|███████████▎                                                                                                                                       | 1/13 [00:04<00:49,  4.14s/it, loss=0.0449]

Epoch [6/200]:  15%|██████████████████████▌                                                                                                                            | 2/13 [00:08<00:44,  4.01s/it, loss=0.0538]


Epoch [6/200]:  23%|█████████████████████████████████▉                                                                                                                 | 3/13 [00:11<00:39,  3.95s/it, loss=0.0618]

Epoch [6/200]:  31%|█████████████████████████████████████████████▏                                                                                                     | 4/13 [00:15<00:34,  3.89s/it, loss=0.0636]

Epoch [6/200]:  38%|████████████████████████████████████████████████████████▌                                                                                          | 5/13 [00:19<00:31,  3.89s/it, loss=0.0618]

Epoch [6/200]:  46%|████████████████████████████████████████████████████████████████████▎                                                                               | 6/13 [00:23<00:27,  3.96s/it, loss=0.056]

Epoch [6/200]:  54%|███████████████████████████████████████████████████████████████████████████████▏                                                                   | 7/13 [00:27<00:23,  3.98s/it, loss=0.0466]

Epoch [6/200]:  62%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                        | 8/13 [00:31<00:19,  3.99s/it, loss=0.0529]

Epoch [6/200]:  69%|█████████████████████████████████████████████████████████████████████████████████████████████████████▊                                             | 9/13 [00:35<00:16,  4.02s/it, loss=0.0518]

Epoch [6/200]:  77%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                 | 10/13 [00:40<00:12,  4.14s/it, loss=0.0526]

Epoch [6/200]:  85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                      | 11/13 [00:44<00:08,  4.14s/it, loss=0.0611]

Epoch [6/200]:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊           | 12/13 [00:48<00:04,  4.11s/it, loss=0.0529]
torch.Size([124, 512])
lr 0.0014122202241015
Epoch 6
 Current loss 0.05560976924224136
compute roc mode:  testing

torch.Size([64, 512])
compute roc mode:  testing
torch.Size([64, 512])
compute roc mode:  testing
torch.Size([64, 512])
compute roc mode:  testing
torch.Size([64, 512])
compute roc mode:  testing
torch.Size([12, 512])
compute roc mode:  training
torch.Size([64, 512])
compute roc mode:  training
torch.Size([64, 512])
compute roc mode:  training
torch.Size([64, 512])
compute roc mode:  training
torch.Size([64, 512])
compute roc mode:  training
torch.Size([19, 512])
I
I
I
I
C
I
I
I
I
C
C
I
I
C
I
I
C
C
I
I
I
I
I
I
I
C
I
I
I
I
C
Epoch avg. auc value: 0.9488686426637092
Epoch one-shot accuracy: 0.25806451612903225
Best threshold running-average value: 0.891796859105428
  0%|                                                                                                                                                                                       | 0/13 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/home/adriansegura/Desktop/RUG/CattleNet/convnext/setup.py", line 331, in <module>
    model,avg_auc_validation_testing,avg_auc_validation_training = train(d_loader=data_loader,dataset_validation=dataset_validation,dataset_validation_training=dataset_validation_training)
  File "/home/adriansegura/Desktop/RUG/CattleNet/convnext/setup.py", line 113, in train
    for data in loop:
  File "/home/adriansegura/.local/lib/python3.9/site-packages/tqdm/std.py", line 1195, in __iter__
    for obj in iterable:
  File "/home/adriansegura/.local/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 530, in __next__
    data = self._next_data()
  File "/home/adriansegura/.local/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 570, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/adriansegura/.local/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/adriansegura/.local/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/adriansegura/Desktop/RUG/CattleNet/convnext/custom_dataset_bce.py", line 60, in __getitem__
    if self.img_labels.iloc[i,2] == self.img_labels.iloc[idx, 2]:
  File "/home/adriansegura/anaconda3/lib/python3.9/site-packages/pandas/core/indexing.py", line 960, in __getitem__
    return self.obj._get_value(*key, takeable=self._takeable)
  File "/home/adriansegura/anaconda3/lib/python3.9/site-packages/pandas/core/frame.py", line 3612, in _get_value
    series = self._ixs(col, axis=1)
  File "/home/adriansegura/anaconda3/lib/python3.9/site-packages/pandas/core/frame.py", line 3442, in _ixs
    result = self._box_col_values(col_mgr, i)
  File "/home/adriansegura/anaconda3/lib/python3.9/site-packages/pandas/core/frame.py", line 3915, in _box_col_values
    return klass(values, name=name, fastpath=True).__finalize__(self)
  File "/home/adriansegura/anaconda3/lib/python3.9/site-packages/pandas/core/series.py", line 323, in __init__
    def __init__(
KeyboardInterrupt